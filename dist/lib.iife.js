var BasedCanvas=function(){"use strict";let t=window.devicePixelRatio;const e=[];window.addEventListener("resize",(function(){const i=window.devicePixelRatio;t!==i&&(e.forEach(t=>t()),t=i)}));var i=e.push.bind(e);const s=[],n=s.push.bind(s),h={dpx:0,cpx:0};function a(){const[t,e]=function(){const t=window.devicePixelRatio;for(let i=1;i<100;i++)if(e=t*i,Math.abs(e-(0|e))<.001)return[Math.round(t*i),i];var e;return[1,1]}();h.dpx=t,h.cpx=e,s.forEach(t=>t())}a(),i(a);var r,o,c,d,l,w,p,u,v,g,C,f,M,x,W,k,L,b=function(t,e,i){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,i),i},R=function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)};const m={alpha:!1};class E{constructor(t,e){r.set(this,void 0),o.set(this,void 0),c.set(this,void 0),d.set(this,void 0),l.set(this,void 0),w.set(this,void 0),p.set(this,void 0),u.set(this,void 0),v.set(this,void 0),g.set(this,void 0),C.set(this,void 0),f.set(this,void 0),M.set(this,[]),this.addCtxResizeListener=R(this,M).push.bind(R(this,M)),x.set(this,!1),W.set(this,[]),this.addCanvasResizeListener=R(this,W).push.bind(R(this,W)),k.set(this,!1),L.set(this,[]),this.addContainerResizeListener=R(this,L).push.bind(R(this,L));const i=Object.assign(m,e),s=document.createElement("canvas"),h=s.getContext("2d",i);if(null==h)throw new Error('HTMLElement.getContext("2d") returned null!');t.appendChild(s),n(this.lfprChanged.bind(this)),new ResizeObserver(this.lcontainerResized.bind(this)).observe(t),b(this,r,h),b(this,d,s),b(this,p,t),b(this,g,!!i.overflow),this.fetch()}get ctx(){return R(this,r)}get ctxWidth(){return R(this,o)}get ctxHeight(){return R(this,c)}get canvas(){return R(this,d)}get canvasWidth(){return R(this,l)}get canvasHeight(){return R(this,w)}get container(){return R(this,p)}get containerWidth(){return R(this,u)}get containerHeight(){return R(this,v)}get fprCountX(){return R(this,C)}get fprCountY(){return R(this,f)}lfprChanged(){this.recalc()}lcontainerResized([{contentRect:{width:t,height:e}}]){b(this,u,t),b(this,v,e),this.recalc(),this.callContainerListeners()}fetch(){b(this,o,R(this,d).width),b(this,c,R(this,d).height);const t=window.getComputedStyle(R(this,d));b(this,l,+t.width.slice(-2)),b(this,w,+t.height.slice(-2));const e=window.getComputedStyle(R(this,p));b(this,u,+e.width.slice(-2)),b(this,v,+e.height.slice(-2))}recalc(){const{dpx:t,cpx:e}=h,i=R(this,g)?Math.ceil:Math.floor,s=i(R(this,u)/e),n=i(R(this,v)/e);b(this,C,s),b(this,f,n);const a=s*t,r=n*t,p=a!==R(this,o)||r!==R(this,c),M=s*e,x=n*e,W=M!==R(this,l)||x!==R(this,w);p&&(R(this,d).width=a,R(this,d).height=r,b(this,o,a),b(this,c,r)),W&&(R(this,d).style.width=`${M}px`,R(this,d).style.height=`${x}px`,b(this,l,M),b(this,w,x)),p&&this.callCtxListeners(),W&&this.callCanvasListeners()}callCtxListeners(){!1===R(this,x)&&(window.requestAnimationFrame(this.actuallyCallCtxListeners.bind(this)),b(this,k,!0))}actuallyCallCtxListeners(){R(this,M).forEach(t=>t()),R(this,x)}callCanvasListeners(){!1===R(this,k)&&(window.requestAnimationFrame(this.actuallyCallCanvasListeners.bind(this)),b(this,k,!0))}actuallyCallCanvasListeners(){R(this,W).forEach(t=>t()),b(this,k,!1)}callContainerListeners(){R(this,L).forEach(t=>t())}}return r=new WeakMap,o=new WeakMap,c=new WeakMap,d=new WeakMap,l=new WeakMap,w=new WeakMap,p=new WeakMap,u=new WeakMap,v=new WeakMap,g=new WeakMap,C=new WeakMap,f=new WeakMap,M=new WeakMap,x=new WeakMap,W=new WeakMap,k=new WeakMap,L=new WeakMap,E.currentFPR=h,E.addFPRListener=n,E}();
//# sourceMappingURL=lib.iife.js.map
